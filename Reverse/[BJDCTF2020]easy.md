## [BJDCTF2020]easy----------BUUCTF刷题

### 运行程序观察程序特征

首先运行程序，得到如下图所示：

![图1](D:\Binary_Study\[BJDCTF2020]easy\1.PNG)

由上图可以得到以下几点：

- 没有输入字符串
- 根据提示和无输入，推测flag在程序内部，某个函数或者数据块中



### 程序查壳

![图2](D:\Binary_Study\[BJDCTF2020]easy\2.PNG)

由上图可知，该程序无壳，且为32位程序



### IDA静态分析

根据程序的提示信息，将程序拖入IDA，进入到主函数，如下图：

![图3](D:\Binary_Study\[BJDCTF2020]easy\3.PNG)

如上图所示，主函数中，输出提示的字符串，没有可用信息；

所以，进一步查看程序中是否具有可疑字符串，如下图所示，很明显也没有什么有价值的可疑字符串

![图4](D:\Binary_Study\[BJDCTF2020]easy\4.PNG)



由于没有可疑信息，根据以往做题经验查看，是否有类似于 .fini和 .init等可执行的可疑区段，一级可疑存储数据，通过工具和都未发现；

通过查看wp了解到了一个可疑函数，如下图所示：

![图5](D:\Binary_Study\[BJDCTF2020]easy\5.png)

上图中，_ques函数没有被程序中任何地方引用

![图6](D:\Binary_Study\[BJDCTF2020]easy\6.png)

由上图_ques的内容可以看到，该函数进行了一定的处理，调用putchar()函数，进行了字符串输出；

前面提到，因为该函数，没有调用，所以，字符也就没有输出，结合提示，推测此处很可能是Flag

使用IDA 的动态调试，将断点下载 mian() 函数中，运行程序，断下来，然后通过修改EIP的值位_ques函数的入口，从而跳转执行该函数

然后得到下图

![图7](D:\Binary_Study\[BJDCTF2020]easy\7.png)



即为***flag{HACKIT4FUN}***