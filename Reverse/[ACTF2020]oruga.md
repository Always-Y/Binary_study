# [ACTF2020] oruga

- 迷宫题



### 运行程序观察特征

很简单，不多说



### 查壳

无壳



### IDA 静态分析

这个题本质上是一个迷宫题，比较容易分析，使用WMJE 四个字母对应上下左右进行移动

**关键是要注意，要读懂循环中所嵌套的循环，当输入一个字母移动时，嵌套里的循环会导致目标一直移动，直到所在位置的值不为0，这与普通的迷宫(按键一次移动一个位置)不同**更像是碰碰车的玩法，选定一个方向一直移动，直到遇到障碍物停下，然后再次移动



### 脚本

```c++
#include <iostream>

using namespace std;

int main(){
	int maze[256]={
		0x0,0x0,0x0,0x0,0x23,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x23,0x23,0x23,0x23,
0x0,0x0,0x0,0x23,0x23,0x0,0x0,0x0,0x4f,0x4f,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x4f,0x4f,0x0,0x50,0x50,0x0,0x0,0x0,
0x0,0x0,0x0,0x4c,0x0,0x4f,0x4f,0x0,0x4f,0x4f,0x0,0x50,0x50,0x0,0x0,0x0,
0x0,0x0,0x0,0x4c,0x0,0x4f,0x4f,0x0,0x4f,0x4f,0x0,0x50,0x0,0x0,0x0,0x0,
0x0,0x0,0x4c,0x4c,0x0,0x4f,0x4f,0x0,0x0,0x0,0x0,0x50,0x0,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x4f,0x4f,0x0,0x0,0x0,0x0,0x50,0x0,0x0,0x0,0x0,
0x23,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x23,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x4d,0x4d,0x4d,0x0,0x0,0x0,0x23,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x4d,0x4d,0x4d,0x0,0x0,0x0,0x0,0x45,0x45,
0x0,0x0,0x0,0x30,0x0,0x4d,0x0,0x4d,0x0,0x4d,0x0,0x0,0x0,0x0,0x45,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x45,0x45,
0x54,0x54,0x54,0x49,0x0,0x4d,0x0,0x4d,0x0,0x4d,0x0,0x0,0x0,0x0,0x45,0x0,
0x0,0x54,0x0,0x49,0x0,0x4d,0x0,0x4d,0x0,0x4d,0x0,0x0,0x0,0x0,0x45,0x0,
0x0,0x54,0x0,0x49,0x0,0x4d,0x0,0x4d,0x0,0x4d,0x21,0x0,0x0,0x0,0x45,0x45
	};
	for(int i=0;i<256;i++){
		if((i%16==0)&&(i!=0))
			cout<<endl;
		if(i==0)
			cout<<"☆";	//起点 
		else{
			if(maze[i]==0)
				cout<<"□";// 路
			else if(maze[i]==0x21)
				cout<<"★";//终点
			else
				cout<<"■";//其他都是障碍 
		}
	}
	return 0;
}
```



### 效果图

![图](https://ms-study.oss-cn-chengdu.aliyuncs.com/Binary_study/RE/%5BACTF2020%5Doruga.png)